#DECLARATION DES VARIABLES
$computer = hostname
$port = "10050"
$server = "YOUR_SERVER_IP"
$msi = "zabbix_agent-6.0.12-windows-amd64-openssl.msi"
$folder = "C:\Program Files\Zabbix Agent\zabbix_agentd.exe"
$tmp = "C:\Windows\Temp"
$download = "\\xmalicia\install_auto$\Zabbix"
$metadata = "windows"
echo "   ETAPE 1 : Vérification de la présence de Zabbix "
If((Test-Path $folder))
{
  Write-Output "Appli déjà présente"
}else{
  Write-Output "Appli à installer"
  Copy-Item -Path "$download\$msi" -Destination "$tmp\$msi"
}
echo "   ETAPE 3 : Installation de l'agent Zabbix    "
msiexec /l*v log.txt /i "$tmp\$msi" /qn SERVER=$server LISTENPORT=$port  SERVERACTIVE=$server  HOSTNAME=$computer HOSTMETADATA=$metadata
Start-Sleep -Seconds 5
echo "   ETAPE 4 : Verification de l'installation "
If((Test-Path $folder))
{
    Write-Output "L'application a bien été installé"
}else{
    Write-Output "L'application n'a pas pu être installé"
}
# SIG # Begin signature block
# MIIZjQYJKoZIhvcNAQcCoIIZfjCCGXoCAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUElGbS9nR0XtslwQ99xhQ33IA
# SqqgghOoMIIFujCCBKKgAwIBAgITaQAAAOhLZBDTdjq3AgAAAAAA6DANBgkqhkiG
# 9w0BAQsFADBHMRIwEAYKCZImiZPyLGQBGRYCZnIxGDAWBgoJkiaJk/IsZAEZFghh
# ZXJvcG9sZTEXMBUGA1UEAxMOQ0EtWC1QUk9GRVNTT1IwHhcNMjIwNTEyMDgxMTAz
# WhcNMjMwNTEyMDgxMTAzWjCBhzESMBAGCgmSJomT8ixkARkWAmZyMRgwFgYKCZIm
# iZPyLGQBGRYIYWVyb3BvbGUxHzAdBgNVBAsTFkRJUkVDVElPTiBJTkRVU1RSSUVM
# TEUxDTALBgNVBAsTBElORk8xDzANBgNVBAsTBkFkbWluczEWMBQGA1UEAxMNbmlj
# b2xhcyBhZG1pbjCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAM45foEL
# iou8/0V59hPliQDjun2FwbSjZGA5uaPqa4Wd8v4ico5imStKx4CYWSkr8p68I2ZX
# jRplUkHkTdWQQl8dkl0of9cllvWnCEm0DC0BtLR8cV6yiPVWxs5ZU4g/fjna/4p3
# rMBKo3EUDPq7hIhqqp6PD5EAqPJMQP4mOKZzwjeMTvaRq2MCSG4v5juq9h37MLzI
# NtImc/exNyAaoEhCYDLZ/1c1Xhr1lfnaHqDboIo2/MxJNV5VgKDMW2Y/hTVLlAoq
# ZUjbBzT9FR4LY7NfL7/4GoJWHtj4/tnoijQRU6C+P6pXPSvuyZqfnt1y9amnP1Vd
# cTGPSu0XqlPhij8CAwEAAaOCAlwwggJYMCUGCSsGAQQBgjcUAgQYHhYAQwBvAGQA
# ZQBTAGkAZwBuAGkAbgBnMBMGA1UdJQQMMAoGCCsGAQUFBwMDMA4GA1UdDwEB/wQE
# AwIHgDAdBgNVHQ4EFgQU3B+wnAUndbk/Ark1s9Evl8FSqTUwHwYDVR0jBBgwFoAU
# 4FOGotDgYyFvzPWCLVyqkk3AXVcwgdAGA1UdHwSByDCBxTCBwqCBv6CBvIaBuWxk
# YXA6Ly8vQ049Q0EtWC1QUk9GRVNTT1IsQ049eC1wcm9mZXNzb3IsQ049Q0RQLENO
# PVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZpZ3Vy
# YXRpb24sREM9YWVyb3BvbGUsREM9ZnI/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlz
# dD9iYXNlP29iamVjdENsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MIHABggrBgEF
# BQcBAQSBszCBsDCBrQYIKwYBBQUHMAKGgaBsZGFwOi8vL0NOPUNBLVgtUFJPRkVT
# U09SLENOPUFJQSxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1TZXJ2aWNl
# cyxDTj1Db25maWd1cmF0aW9uLERDPWFlcm9wb2xlLERDPWZyP2NBQ2VydGlmaWNh
# dGU/YmFzZT9vYmplY3RDbGFzcz1jZXJ0aWZpY2F0aW9uQXV0aG9yaXR5MDQGA1Ud
# EQQtMCugKQYKKwYBBAGCNxQCA6AbDBluaWNvbGFzLmFkbWluQHNlcm1ldGEuY29t
# MA0GCSqGSIb3DQEBCwUAA4IBAQCcwJjqkbMrPqUCyAh56f7eag7a934Wf22QN/Zl
# HUT56OMR9DwolktA3vZHAf9XqYH4KRObF6ukgXRfT2EV7daSiXzp7SmI7CfqhkH6
# eBbYb1gr3wv4ceM/9/WmtJ78Lq74BZnX/j4V2wiGnZfY4S5rjEntVDc3TYyKW50z
# t3zF9At/hlqqNKcnIKQxzAc2b9/zVzt9xKZ6fR7uWQUeP7zxoEPe/UIvF93m2PfQ
# 0B3DtiUbld9ZMT2V68XihXaTeS07PJ16H8HJxhhwVGjpewp85T4hHZ+jGFD6OuV4
# gmMuu46hIP/9hZnvLU40V6kq1M5ly2A89Vxrn6AkIyzVNjJvMIIG7DCCBNSgAwIB
# AgIQMA9vrN1mmHR8qUY2p3gtuTANBgkqhkiG9w0BAQwFADCBiDELMAkGA1UEBhMC
# VVMxEzARBgNVBAgTCk5ldyBKZXJzZXkxFDASBgNVBAcTC0plcnNleSBDaXR5MR4w
# HAYDVQQKExVUaGUgVVNFUlRSVVNUIE5ldHdvcmsxLjAsBgNVBAMTJVVTRVJUcnVz
# dCBSU0EgQ2VydGlmaWNhdGlvbiBBdXRob3JpdHkwHhcNMTkwNTAyMDAwMDAwWhcN
# MzgwMTE4MjM1OTU5WjB9MQswCQYDVQQGEwJHQjEbMBkGA1UECBMSR3JlYXRlciBN
# YW5jaGVzdGVyMRAwDgYDVQQHEwdTYWxmb3JkMRgwFgYDVQQKEw9TZWN0aWdvIExp
# bWl0ZWQxJTAjBgNVBAMTHFNlY3RpZ28gUlNBIFRpbWUgU3RhbXBpbmcgQ0EwggIi
# MA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQDIGwGv2Sx+iJl9AZg/IJC9nIAh
# VJO5z6A+U++zWsB21hoEpc5Hg7XrxMxJNMvzRWW5+adkFiYJ+9UyUnkuyWPCE5u2
# hj8BBZJmbyGr1XEQeYf0RirNxFrJ29ddSU1yVg/cyeNTmDoqHvzOWEnTv/M5u7mk
# I0Ks0BXDf56iXNc48RaycNOjxN+zxXKsLgp3/A2UUrf8H5VzJD0BKLwPDU+zkQGO
# bp0ndVXRFzs0IXuXAZSvf4DP0REKV4TJf1bgvUacgr6Unb+0ILBgfrhN9Q0/29Dq
# hYyKVnHRLZRMyIw80xSinL0m/9NTIMdgaZtYClT0Bef9Maz5yIUXx7gpGaQpL0bj
# 3duRX58/Nj4OMGcrRrc1r5a+2kxgzKi7nw0U1BjEMJh0giHPYla1IXMSHv2qyghY
# h3ekFesZVf/QOVQtJu5FGjpvzdeE8NfwKMVPZIMC1Pvi3vG8Aij0bdonigbSlofe
# 6GsO8Ft96XZpkyAcSpcsdxkrk5WYnJee647BeFbGRCXfBhKaBi2fA179g6JTZ8qx
# +o2hZMmIklnLqEbAyfKm/31X2xJ2+opBJNQb/HKlFKLUrUMcpEmLQTkUAx4p+hul
# Iq6lw02C0I3aa7fb9xhAV3PwcaP7Sn1FNsH3jYL6uckNU4B9+rY5WDLvbxhQiddP
# nTO9GrWdod6VQXqngwIDAQABo4IBWjCCAVYwHwYDVR0jBBgwFoAUU3m/WqorSs9U
# gOHYm8Cd8rIDZsswHQYDVR0OBBYEFBqh+GEZIA/DQXdFKI7RNV8GEgRVMA4GA1Ud
# DwEB/wQEAwIBhjASBgNVHRMBAf8ECDAGAQH/AgEAMBMGA1UdJQQMMAoGCCsGAQUF
# BwMIMBEGA1UdIAQKMAgwBgYEVR0gADBQBgNVHR8ESTBHMEWgQ6BBhj9odHRwOi8v
# Y3JsLnVzZXJ0cnVzdC5jb20vVVNFUlRydXN0UlNBQ2VydGlmaWNhdGlvbkF1dGhv
# cml0eS5jcmwwdgYIKwYBBQUHAQEEajBoMD8GCCsGAQUFBzAChjNodHRwOi8vY3J0
# LnVzZXJ0cnVzdC5jb20vVVNFUlRydXN0UlNBQWRkVHJ1c3RDQS5jcnQwJQYIKwYB
# BQUHMAGGGWh0dHA6Ly9vY3NwLnVzZXJ0cnVzdC5jb20wDQYJKoZIhvcNAQEMBQAD
# ggIBAG1UgaUzXRbhtVOBkXXfA3oyCy0lhBGysNsqfSoF9bw7J/RaoLlJWZApbGHL
# tVDb4n35nwDvQMOt0+LkVvlYQc/xQuUQff+wdB+PxlwJ+TNe6qAcJlhc87QRD9XV
# w+K81Vh4v0h24URnbY+wQxAPjeT5OGK/EwHFhaNMxcyyUzCVpNb0llYIuM1cfwGW
# vnJSajtCN3wWeDmTk5SbsdyybUFtZ83Jb5A9f0VywRsj1sJVhGbks8VmBvbz1kte
# raMrQoohkv6ob1olcGKBc2NeoLvY3NdK0z2vgwY4Eh0khy3k/ALWPncEvAQ2ted3
# y5wujSMYuaPCRx3wXdahc1cFaJqnyTdlHb7qvNhCg0MFpYumCf/RoZSmTqo9CfUF
# bLfSZFrYKiLCS53xOV5M3kg9mzSWmglfjv33sVKRzj+J9hyhtal1H3G/W0NdZT1Q
# gW6r8NDT/LKzH7aZlib0PHmLXGTMze4nmuWgwAxyh8FuTVrTHurwROYybxzrF06U
# w3hlIDsPQaof6aFBnf6xuKBlKjTg3qj5PObBMLvAoGMs/FwWAKjQxH/qEZ0eBsam
# bTJdtDgJK0kHqv3sMNrxpy/Pt/360KOE2See+wFmd7lWEOEgbsausfm2usg1XTN2
# jvF8IAwqd661ogKGuinutFoAsYyr4/kKyVRd1LlqdJ69SK6YMIIG9jCCBN6gAwIB
# AgIRAJA5f5rSSjoT8r2RXwg4qUMwDQYJKoZIhvcNAQEMBQAwfTELMAkGA1UEBhMC
# R0IxGzAZBgNVBAgTEkdyZWF0ZXIgTWFuY2hlc3RlcjEQMA4GA1UEBxMHU2FsZm9y
# ZDEYMBYGA1UEChMPU2VjdGlnbyBMaW1pdGVkMSUwIwYDVQQDExxTZWN0aWdvIFJT
# QSBUaW1lIFN0YW1waW5nIENBMB4XDTIyMDUxMTAwMDAwMFoXDTMzMDgxMDIzNTk1
# OVowajELMAkGA1UEBhMCR0IxEzARBgNVBAgTCk1hbmNoZXN0ZXIxGDAWBgNVBAoT
# D1NlY3RpZ28gTGltaXRlZDEsMCoGA1UEAwwjU2VjdGlnbyBSU0EgVGltZSBTdGFt
# cGluZyBTaWduZXIgIzMwggIiMA0GCSqGSIb3DQEBAQUAA4ICDwAwggIKAoICAQCQ
# snE/eeHUuYoXzMOXwpCUcu1aOm8BQ39zWiifJHygNUAG+pSvCqGDthPkSxUGXmqK
# IDRxe7slrT9bCqQfL2x9LmFR0IxZNz6mXfEeXYC22B9g480Saogfxv4Yy5NDVnrH
# zgPWAGQoViKxSxnS8JbJRB85XZywlu1aSY1+cuRDa3/JoD9sSq3VAE+9CriDxb2Y
# LAd2AXBF3sPwQmnq/ybMA0QfFijhanS2nEX6tjrOlNEfvYxlqv38wzzoDZw4ZtX8
# fR6bWYyRWkJXVVAWDUt0cu6gKjH8JgI0+WQbWf3jOtTouEEpdAE/DeATdysRPPs9
# zdDn4ZdbVfcqA23VzWLazpwe/OpwfeZ9S2jOWilh06BcJbOlJ2ijWP31LWvKX2TH
# aygM2qx4Qd6S7w/F7KvfLW8aVFFsM7ONWWDn3+gXIqN5QWLP/Hvzktqu4DxPD1rM
# bt8fvCKvtzgQmjSnC//+HV6k8+4WOCs/rHaUQZ1kHfqA/QDh/vg61MNeu2lNcpnl
# 8TItUfphrU3qJo5t/KlImD7yRg1psbdu9AXbQQXGGMBQ5Pit/qxjYUeRvEa1RlNs
# xfThhieThDlsdeAdDHpZiy7L9GQsQkf0VFiFN+XHaafSJYuWv8at4L2xN/cf30J7
# qusc6es9Wt340pDVSZo6HYMaV38cAcLOHH3M+5YVxQIDAQABo4IBgjCCAX4wHwYD
# VR0jBBgwFoAUGqH4YRkgD8NBd0UojtE1XwYSBFUwHQYDVR0OBBYEFCUuaDxrmisk
# FKkfot8mOs8UpvHgMA4GA1UdDwEB/wQEAwIGwDAMBgNVHRMBAf8EAjAAMBYGA1Ud
# JQEB/wQMMAoGCCsGAQUFBwMIMEoGA1UdIARDMEEwNQYMKwYBBAGyMQECAQMIMCUw
# IwYIKwYBBQUHAgEWF2h0dHBzOi8vc2VjdGlnby5jb20vQ1BTMAgGBmeBDAEEAjBE
# BgNVHR8EPTA7MDmgN6A1hjNodHRwOi8vY3JsLnNlY3RpZ28uY29tL1NlY3RpZ29S
# U0FUaW1lU3RhbXBpbmdDQS5jcmwwdAYIKwYBBQUHAQEEaDBmMD8GCCsGAQUFBzAC
# hjNodHRwOi8vY3J0LnNlY3RpZ28uY29tL1NlY3RpZ29SU0FUaW1lU3RhbXBpbmdD
# QS5jcnQwIwYIKwYBBQUHMAGGF2h0dHA6Ly9vY3NwLnNlY3RpZ28uY29tMA0GCSqG
# SIb3DQEBDAUAA4ICAQBz2u1ocsvCuUChMbu0A6MtFHsk57RbFX2o6f2t0ZINfD02
# oGnZ85ow2qxp1nRXJD9+DzzZ9cN5JWwm6I1ok87xd4k5f6gEBdo0wxTqnwhUq//E
# fpZsK9OU67Rs4EVNLLL3OztatcH714l1bZhycvb3Byjz07LQ6xm+FSx4781FoADk
# +AR2u1fFkL53VJB0ngtPTcSqE4+XrwE1K8ubEXjp8vmJBDxO44ISYuu0RAx1QcIP
# NLiIncgi8RNq2xgvbnitxAW06IQIkwf5fYP+aJg05Hflsc6MlGzbA20oBUd+my7w
# ZPvbpAMxEHwa+zwZgNELcLlVX0e+OWTOt9ojVDLjRrIy2NIphskVXYCVrwL7tNEu
# nTh8NeAPHO0bR0icImpVgtnyughlA+XxKfNIigkBTKZ58qK2GpmU65co4b59G6F8
# 7VaApvQiM5DkhFP8KvrAp5eo6rWNes7k4EuhM6sLdqDVaRa3jma/X/ofxKh/p6FI
# FJENgvy9TZntyeZsNv53Q5m4aS18YS/to7BJ/lu+aSSR/5P8V2mSS9kFP22GctOi
# 0MBk0jpCwRoD+9DtmiG4P6+mslFU1UzFyh8SjVfGOe1c/+yfJnatZGZn6Kow4NKt
# t32xakEnbgOKo3TgigmCbr/j9re8ngspGGiBoZw/bhZZSxQJCZrmrr9gFd2G9TGC
# BU8wggVLAgEBMF4wRzESMBAGCgmSJomT8ixkARkWAmZyMRgwFgYKCZImiZPyLGQB
# GRYIYWVyb3BvbGUxFzAVBgNVBAMTDkNBLVgtUFJPRkVTU09SAhNpAAAA6EtkENN2
# OrcCAAAAAADoMAkGBSsOAwIaBQCgeDAYBgorBgEEAYI3AgEMMQowCKACgAChAoAA
# MBkGCSqGSIb3DQEJAzEMBgorBgEEAYI3AgEEMBwGCisGAQQBgjcCAQsxDjAMBgor
# BgEEAYI3AgEVMCMGCSqGSIb3DQEJBDEWBBRdhoF2xivfnX0CEvMkf4aokKhOGDAN
# BgkqhkiG9w0BAQEFAASCAQBILJj+M9ITgiPhhz02Gi4yxuwwFvgex45VAc/gQbET
# PuIswAzh/NfO+KhHvEAlJoc5tYeykqgUj0xMiDrj55vrj/QFuVGRy+ScnizUixVI
# UchNRW4Un6hEbb7JRvnpkxoLPXCNN4SEvO3grhHLshqCqhdRcxdSwMYC0ZJkeSLJ
# QexQFa+s3UEh/hvKzJ22PdcWMs4aoViZJDogRc7Typ96pTfvmSJbtBweJirkub+A
# DJIYsM1KJv08TG6jFub158nODXHBtABw51onBy86rIiaT34MyQbpp0P2SruaXdrN
# HH6d1U1Ki5TxyU4ExIUO6KtjhNWDehQpB7Yuj2L0l1EZoYIDTDCCA0gGCSqGSIb3
# DQEJBjGCAzkwggM1AgEBMIGSMH0xCzAJBgNVBAYTAkdCMRswGQYDVQQIExJHcmVh
# dGVyIE1hbmNoZXN0ZXIxEDAOBgNVBAcTB1NhbGZvcmQxGDAWBgNVBAoTD1NlY3Rp
# Z28gTGltaXRlZDElMCMGA1UEAxMcU2VjdGlnbyBSU0EgVGltZSBTdGFtcGluZyBD
# QQIRAJA5f5rSSjoT8r2RXwg4qUMwDQYJYIZIAWUDBAICBQCgeTAYBgkqhkiG9w0B
# CQMxCwYJKoZIhvcNAQcBMBwGCSqGSIb3DQEJBTEPFw0yMzAxMTYwODI1NDNaMD8G
# CSqGSIb3DQEJBDEyBDBSXmCCP177kCgB9N89l6nIqHyj1fq2qpz5rWZNnRdlzJci
# u+TAj1yf9uwp2R02t3gwDQYJKoZIhvcNAQEBBQAEggIAD+hEe2PkYPESVURrZwM9
# cNAYRR9OAerMjNidptZR+C16/dTKGozA2TQszR5K2wOXvrL6ncCGJSBhfHcAOIZK
# O7cGrGHO4eVzeRW4rPF3NO98wL4DDx8m8bB6IELqUQMz60rPFDbOnBhr2aHadDM3
# 5nZzBFqsaDNVSLgiLxjht2ZQHsTI+2L/sKMofRpWK1j3Bfc6/SeP8LP+lf8NAcdV
# o/UtHcKNoKcAab/d7385ue/5gDiyp3k1DZXjC42257RpLgaTQ9J5f2zDVhmSkZsv
# 1e2DVDQgZWRxBywyAM7aKjGm1pZFzdNLCAYmpDs5G81Ugl4Z3WwtPqEHugM5vFAb
# EYdKgftqUa/Diw6XzVttWDn+O2/v5A2TwqQczMb3DztXawuwltHr6Averapo70Y+
# jM3OYuI1vexzrFhQkKVVChCY8gLxhP15nkH4jaG/wJ+1n3NpsX2ArHuLc4waKYUs
# 4d0UrI4bHvebOO2TyBZq/LfPTAEWYu0VzPMyKejD28Pf6oPDNCoQ41nX/cc6CMUf
# soyVWijtpOUvXdj61pnXKXubjbxHJwK32w5osyY4V6iqHugsFY3Bdf6/kcSjbn0l
# sUD5esURiliwQdhSM8/ZKleJYz/VdCaOrgjbLRph8OtUdfq2p4+g/f1EUGLKl0pC
# ZydLl+UjxkGYklrSOLYANvk=
# SIG # End signature block
